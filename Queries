/*
SELECTS the top countries in terms of customer numbers and displays only 10 records
*/

SELECT COUNT (customer_id) AS total_number_of_customers, D.country
FROM customer A
INNER JOIN address B ON A.address_id = B.address_id
INNER JOIN city C ON B.city_id = C.city_id
INNER JOIN country D ON C.country_id = D.country_id
GROUP BY country
ORDER BY COUNT (customer_id) DESC
LIMIT 10

################################################################################

/*
SELECTS the top cities within the top 10 countries and displays only 10 records
*/

SELECT COUNT (customer_id) AS total_number_of_customers, C.city, D.country
FROM customer A
INNER JOIN address B ON A.address_id = B.address_id
INNER JOIN city C ON B.city_id = C.city_id
INNER JOIN country D ON C.country_id = D.country_id
WHERE country IN ('India', 
			    'China', 
			    'United States', 
			    'Japan', 
			    'Mexico', 
		  	    'Brazil', 
			    'Russian Federation',
			    'Philippines',
			    'Turkey',
			    'Indonesia')
GROUP BY city, country
ORDER BY COUNT (customer_id) DESC
LIMIT 10

################################################################################

/*
SELECTS the top customers in the top 10 cities who have paid the highest amount and displays only 5 records

SELECT B.customer_id, B.first_name, B.last_name, SUM(A.amount) AS total_amount_paid, D.city, E.country
FROM payment A
INNER JOIN customer B ON A.customer_id = B.customer_id
INNER JOIN address C ON B.address_id = C.address_id
INNER JOIN city D ON C.city_id = D.city_id
INNER JOIN country E on D.country_id = E.country_id
WHERE city IN ('Aurora', 
				  'Atlixco', 
				  'Xintai', 
				  'Adoni', 
				  'Dhule (Dhulia)', 
				  'Kurashiki', 
				  'Pingxiang',
				  'Sivas',
				  'Celaya',
				  'So Leopoldo')
GROUP BY B.customer_id, B.first_name, B.last_name, city, country
ORDER BY total_amount_paid DESC
LIMIT 5
